---
title: 使用 KimariPlot 绘制化学反应能量折线图和曲线图
date: 2023-06-28 11:59:03
tags:
    - Python
    - KimariPlot
    - Numpy
    - Matplotlib
categories: 
    - Python
description: KimariPlot 是一个用来绘制化学能量图的小程序，目前来说功能不多，但是绘图十分简单，懒人专用。目前开源于 Github (https://github.com/kimariyb/kimariPlot)
---

<p><strong style="color:red; font-size:16pt;">注！本文所介绍的 KimariPlot 工具，本质上和 KimariDraw 1 是一致的！但是和 KimariDraw 2 的功能完全不相同！</strong></p>

<p><strong style="color:red; font-size:16pt;">注！请注意 KimariPlot 输入文件 KimariPlot Input File (.kpi) 与 KimariDraw 1 输入文件 (.kd) 文件的区别。</strong></p>

## 前言

最近笔者在闲来无事的时候，使用 Python 写了一个小程序 KimariDraw。KimariDraw 是一个是一个用来绘制化学能量图的小程序。KimariDraw 在最近最后一次更新至 1.2.0 后，将停止更新，并且将重构整个项目。笔者将 KimariDraw 1.2.0 的所有功能都移植到了 KimariPlot 1.0.0 中，并且在原有的基础上添加了很多可自定义的选项，也增加了另一种势图的绘制。算是一个不小的升级。

目前 KimariDraw 1.2.0 已经停止维护。但是还可以通过 `pip install kimariDraw` 安装。KimariPlot 并没有在 pypi 上托管，因此无法通过 `pip install` 命令安装。具体的安装和使用方法，可以浏览 KimariPlot 的 [Github](https://github.com/kimariyb/kimariPlot) 主页。

和 KimariDraw 相比，最大的区别就是输入文件的不同。KimariDraw 是使用 `.kd` 文件作为输入的文件，而 KimariPlot 则需要提供 `.kpi` 文件。`.kpi` 文件是 KimariPlot 唯一支持的可解析的文件类型，格式非常简单。使用 KimariPlot 绘制势能图是否方便和快捷，下面介绍如何使用 KimariPlot 绘制势能图。

## 绘制势能折线图

KimariPlot 能够很方便的绘制化学反应势能折线图。首先准备一个 `line.kpi` 文件，文件的内容如下：

```basic
%title = Chemdraw Energy Profile
%x = Reaction Coordinate
%y = Free Energy
%unit = kcal/mol
%size = 10, 4
%style = line
%color = #FF69B4, #FF69B4, black
%font = Arial

begin
1   0.0
2   24.0
3   0.1
4   28.6
5   15.7
6   -40.1
end
```

接着启动 KimariPlot，并将 `.kpi` 文件输入，所绘制的结果如下图所示：

<img src="1.png" width="80%">

## 绘制势能曲线图

除了绘制化学反应的反应势能折线图，还可以绘制势能曲线图。这里还是准备一个 `.kpi` 格式的文件 `curve.kpi`，文件的内容如下：

```basic
%title = Scan of Total Energy
%x = Scan Coordinate
%y = Total Energy
%unit = Hartree
%size = 10, 4
%style = curve
%color = #1F77B4, #0570B0, black
%font = Arial

begin
0.0000000000         -0.0224308684
10.0000000000        -0.0227822186
20.0000000000        -0.0237768800
30.0000000000        -0.0252463093
40.0000000000        -0.0269347205
50.0000000000        -0.0285292295
60.0000000000        -0.0297127105
70.0000000000        -0.0302562882
80.0000000000        -0.0301301591
90.0000000000        -0.0295233514
100.0000000000       -0.0287445518
110.0000000000       -0.0280930633
120.0000000000       -0.0277837870
130.0000000000       -0.0279120266
140.0000000000       -0.0284404392
150.0000000000       -0.0292140722
160.0000000000       -0.0300082520
170.0000000000       -0.0305959763
180.0000000000       -0.0308119377
190.0000000000       -0.0305959836
200.0000000000       -0.0300083057
210.0000000000       -0.0292141712
220.0000000000       -0.0284405103
230.0000000000       -0.0279120989
240.0000000000       -0.0277838449
250.0000000000       -0.0280931468
260.0000000000       -0.0287446411
270.0000000000       -0.0295235605
280.0000000000       -0.0301302672
290.0000000000       -0.0302564711
300.0000000000       -0.0297127323
310.0000000000       -0.0285294907
320.0000000000       -0.0269348603
330.0000000000       -0.0252465543
340.0000000000       -0.0237771540
350.0000000000       -0.0227824749
360.0000000000       -0.0224311280
end
```

接着启动 KimariPlot，并将 `.kpi` 文件输入，所绘制的结果如下图所示：

<img src="2.png" width="80%">
