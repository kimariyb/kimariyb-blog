---
title: Multiwfn + VMD 绘制 IRI 以及 IRI-pi 等值面图
date: 2023-06-23 10:50:37
tags:    
    - IRI
    - 相互作用
    - Multiwfn
    - Gaussian
    - VMD
    - 量子化学
categories: 
	- Computer Chemistry
description: IRI 是 Sob 命名的一种研究相互作用的实空间函数，本文主要介绍其等值面图的绘制的方法。本文参考了 Sob 老师《使用 IRI 方法图形化考察化学体系中的化学键和弱相互作用》(http://sobereva.com/598)一文。
---

## 前言

相互作用区域指示函数（IRI）是一个用来以图形化方法研究体系弱相互作用、化学键的实空间函数。通过 IRI 等值面图，可以清晰的观察到体系存在何种相互作用，包括离子键、共价键、氢键以及更弱的范德华力，这对于我们研究一个体系中的各种相互作用有着重要的意义。本文主要参考了 Sob 老师[《使用 IRI 方法图形化考察化学体系中的化学键和弱相互作用》](http://sobereva.com/598)一文。本文所有的计算都是在 Rocky Linux 8 下使用 Gaussian 16 计算完成，使用 [Multiwfn 3.8(dev)](http://sobereva.com/multiwfn/) 计算 IRI、IRI-pi 并生成 IRI 以及 IRI-pi 的平面填色图，使用 VMD 渲染得到 IRI 以及 IRI-pi 的等值面图。

## IRI 绘制实例

本文将计算 IRI 的体系是下图中，1,3-二羰基化合物的烯醇式（右边化合物），为了和实际环境接近，优化该化合物是在 B3LYP(D3)/6-311G* 的级别下，结合 PCM 隐式溶剂模型计算的。

<img src="1.png" height="55%" width="55%">

计算的输入文件如下：

```gjf
%chk=Enol.chk
# opt freq b3lyp/6-311g* em=gd3bj scrf

opt

0 1
 C                 -0.24414368    3.72866273   -4.10825379
 C                 -0.28856917    4.84969755   -3.26847449
 C                 -0.47907167    4.68534362   -1.88984526
 C                 -0.62514597    3.39995471   -1.35099499
 C                 -0.58071968    2.27891985   -2.19077419
 C                 -0.39022020    2.44327396   -3.56940381
 H                 -0.09869403    3.85415080   -5.16086823
 H                 -0.17703595    5.83112037   -3.67989834
 H                 -0.51299075    5.54127853   -1.24865503
 H                 -0.69225018    1.29749687   -1.77934998
 H                 -0.35630116    1.58733905   -4.21059405
 C                 -0.83448392    3.21934567    0.16398290
 C                 -0.97574357    1.97633228    0.68506875
 H                 -0.94182325    1.12039730    0.04387868
 C                 -1.18508169    1.79572326    2.20004662
 C                 -1.34559903    0.38320775    2.79219028
 C                 -1.30116802   -0.73782739    1.95241170
 C                 -1.53609584    0.21885348    4.17082026
 C                 -1.44723910   -2.02321648    2.49126240
 H                 -1.15571552   -0.61233949    0.89979765
 C                 -1.68216621   -1.06653565    4.70967105
 H                 -1.57001611    1.07478846    4.81201034
 C                 -1.63773676   -2.18757070    3.86989226
 H                 -1.41331501   -2.87915169    1.85007282
 H                 -1.82761335   -1.19202387    5.76228581
 H                 -1.74926403   -3.16899387    4.28131689
 O                 -0.87981272    4.36325855    1.02090100
 H                 -1.14605628    4.09229143    1.90254218
 O                 -1.22497473    2.80236681    2.95413406
```

由于优化之后的体系并不处于某一平面上，因此这里就不绘制 IRI 平面填色图了。直接使用 Multiwfn 输出 IRI 格点文件，具体的操作是现将得到的 fchk 文件载入 Multiwfn 中，接着输入：

```basic
20  // 弱相互作用可视化分析
4   // IRI分析
3   // 高质量格点。
3   // Output cube files to func1.cub and func2.cub in current folder
```

将得到的 cub 文件拷贝进 VMD 程序文件夹下进行渲染，具体操作可以参考[《使用 IRI 方法图形化考察化学体系中的化学键和弱相互作用》](http://sobereva.com/598)一文，按照教程就能得到以下图形。根据 IRI 等值面图，可以清晰的看见该体系中的各种相互作用。

<img src="2.png" height="70%" width="70%">

在上图中，绿色的等值面是范德华作用区域（也可以是比如极弱的氢键，这种程度的氢键是色散作用占主导）。如果等值面颜色明显偏红，说明这里存在一定位阻作用，若是鲜红则说明位阻很强。如果等值面颜色明显偏蓝，说明存在显著的吸引作用，比如一般强度的氢键、卤键等。如果等值面完全是蓝色的，说明此处要么是相对来说很强的弱相互作用，要么是化学键作用，在上图有两种蓝色的等值面，一种是共价键的相互作用，另一个就是羟基上的 H 与羰基氧形成的氢键，可以看见这种相互作用很强，是蓝色的。Sob 老师将其整理成了下图，下图清晰的表明了各种颜色在等值面图中的相互作用。

<img src="3.png" height="60%" width="60%">


## IRI-pi 绘制实例

为了更好的展示 IRI-pi，笔者将计算下面化合物的 IRI-pi，这是一个 18 碳环的衍生物，是 Sob 老师的研究课题之一。之所以选择这个化合物，是为了更好的在 IRI-pi 中观察多重键。

<img src="4.png" height="30%" width="30%">

计算的输入文件可以在 [Electronic Structure and Aromaticity of an Unusual Cyclo[18]carbon Precursor, C18Br6, Chem. Eur. J., e202300348 (2023)](https://doi.org/10.1002/chem.202300348) 一文中的 SI 中找到。因为这是已经优化好的结构，所以直接在 wB97XD/def2-TZVP 级别下计算单点即可。

```gjf
%chk=C18Br6.chk
# wb97xd def2TZVP

opt

0 1
 C                 -3.28642340   -2.67960997    0.00000000
 C                 -3.96382201   -1.50632117   -0.00000000
 C                 -3.29425394   -0.27616572    0.00000000
 C                 -2.71271492    0.78325295    0.00000000
 C                 -2.03467442    1.95765355   -0.00000000
 C                 -1.40796044    2.99099046   -0.00000000
 C                 -0.67739861    4.18593114    0.00000000
 C                  0.67739861    4.18593114   -0.00000000
 C                  1.40796044    2.99099046    0.00000000
 C                  2.03467442    1.95765355    0.00000000
 C                  2.71271492    0.78325295   -0.00000000
 C                  3.29425394   -0.27616572   -0.00000000
 C                  3.96382201   -1.50632117    0.00000000
 C                  3.28642340   -2.67960997   -0.00000000
 C                  1.88629350   -2.71482474    0.00000000
 C                  0.67804050   -2.74090651    0.00000000
 C                 -0.67804050   -2.74090651    0.00000000
 C                 -1.88629350   -2.71482474    0.00000000
 Br                -4.14028650   -4.35697431    0.00000000
 Br                -5.84339368   -1.40710613   -0.00000000
 Br                -1.70310718    5.76408044    0.00000000
 Br                 1.70310718    5.76408044   -0.00000000
 Br                 5.84339368   -1.40710613    0.00000000
 Br                 4.14028650   -4.35697431   -0.00000000
```

与 IRI 等值面图一样，Multiwfn 同样也可以绘制 IRI-pi 的等值面图，IRI-pi 图主要用来观察体系的 pi 轨道的相互作用。绘制过程与 IRI 绘制等值面图略微有点区别。因为一开始需要先将 pi 轨道一个一个找出来，好在 Multiwfn 能很简单的完成这项工作，在绘制之前，需要将 Multiwfn 的 `settings.ini` 文件中的 `iuserfunc` 改为 99。之后启动 Multiwfn 载入 fchk 文件，输入以下命令。

```basic
19          // 轨道定域分析
1           // 定域占据轨道
100         // 其他功能（第1部分）
22          // 自动检测 pi 轨道
-1          // 当前轨道处于定域轨道  
0           // 现在检测 pi 轨道然后设置占据数
2           // 将所有其他轨道的占据数设置为零
0           // 回到主菜单
100         // 其他功能（第1部分）
1           // Draw scatter graph between two functions and generate their cube files
1,100       // Calculate pi and user-defined function, the latter corresponds to IRI currently
3           // 高质量格点
3           // 生成相应的格点文件
```

除了绘制 IRI-pi 的等值面图以外，也可以绘制 IRI-pi 的平面填色图，这里绘制在平面 0.5 埃上的 IRI-pi 平面填色图具体命令如下。

```basic
4           // 绘制平面图
24          // IRI
1           // 填色图
[Enter]     // 使用默认的格点数
0           // 设置体系向四周的延展距离（用于定义作图范围）
2           // 2 Bohr
1           // XY平面
0.5a        // Z=0.5埃
此时图像蹦出来了。在上面点右键关闭图像，然后输入下面的内容改进作图效果
8           // 显示键
14          // 棕色
19          // 设置色彩变化方式
2           // Reversed rainbow
4           // 设置原子标签颜色
1           // 红色
1           // 设置色彩刻度下限和上限
0,2
17          // 设置显示标签阈值
2           // 2 Bohr
-1          // 重新绘制
```

<img src="5.png" height="80%" width="80%">

通过 IRI-pi 的填色图和等值面图，可以清晰的看见该体系的 pi 体系的相互作用。在该体系中，有在 pi 平面上、下方有等值面也有绕着键轴出现了环形等值面。前者只是一套 pi 作用的等值面图，而后者表示有两套 pi 作用的等值面图。