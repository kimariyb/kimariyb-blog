---
title: Multiwfn + VMD 绘制 LOL-pi 等值面
date: 2023-06-14 12:11:02
tags:
    - LOL
    - 电子离域
    - Multiwfn
    - Gaussian
    - VMD
    - 量子化学
categories: 
	- Computer Chemistry
description: LOL-pi 是被笔者经常用来研究电子离域路径的实空间函数，本文主要介绍其绘制的方法。本文参考了 Sob 老师《在 Multiwfn 中单独考察 pi 电子结构特征》(http://sobereva.com/432)一文。
---

## 前言

定域化轨道定位函数（Localized Orbital Locator, LOL），是一种可以用来考察电子离域路径的实空间函数，而 LOL 可以进一步分解为分别对 sigma 和 pi 贡献的 LOL-sigma 和 LOL-pi。笔者经常使用 LOL-pi 的等值面和平面填色图来考察一个体系 pi 电子的离域路径，也经常使用 LOL-pi 研究体系的 pi 芳香性。本文主要参考了 Sob 老师的[《在 Multiwfn 中单独考察 pi 电子结构特征》](http://sobereva.com/432)一文中绘制 LOL-pi 填色图的部分。本文的一切计算结果都是在 Fedora Linux 下使用 Gaussian 16 计算得到的，使用了 [Multiwfn 3.8(dev)](http://sobereva.com/multiwfn/)  进行波函数分析和绘制平面填色图，使用 [VMD 1.9.3](https://www.ks.uiuc.edu/Research/vmd/vmd-1.9.3/) 绘制了等值面图。

## 计算实例

本文选取的例子为一个特殊的稠环化合物如下图所示。首先要对其进行几何优化和振动分析，确保其为无虚频的能量极小值结构，本文选择在计算级别为 wB97XD/6-311G\* 下对其进行几何优化和振动分析。由于该化合物很显然是一个 D2h 点群的结构，所以在 Gaussian 中利用点群工具可以很快的完成计算任务。

<img src="1.png" height="30%" width="30%">

几何优化完成确保无虚频后，再在 M06-2X/def2-TZVP 下做一次单点计算，两次计算的输入文件如下。

 ```gjf
# opt freq wb97xd/6-311g*

opt

0 1
 C                 -2.39846780   -0.72483000    0.00000000
 C                 -1.13539216   -1.38169088    0.00000000
 C                  0.00000000   -0.65243992    0.00000000
 C                 -0.00000000    0.65243992    0.00000000
 C                 -1.13539216    1.38169088   -0.00000000
 C                 -2.39846780    0.72483000   -0.00000000
 H                 -3.31311025   -1.28010382    0.00000000
 C                  1.13539216   -1.38169088   -0.00000000
 C                  1.13539216    1.38169088    0.00000000
 H                 -3.31311025    1.28010382   -0.00000000
 C                  2.39846780    0.72483000    0.00000000
 C                  2.39846780   -0.72483000   -0.00000000
 H                  3.31311025    1.28010382    0.00000000
 H                  3.31311025   -1.28010382   -0.00000000
 C                 -0.69299314    2.86595715    0.00000000
 H                 -1.33247333    3.72384121    0.00000000
 C                  0.69299314    2.86595715   -0.00000000
 H                  1.33247333    3.72384121   -0.00000000
 C                 -0.69299314   -2.86595715    0.00000000
 H                 -1.33247333   -3.72384121    0.00000000
 C                  0.69299314   -2.86595715    0.00000000
 H                  1.33247333   -3.72384121    0.00000000
 ```

```gjf
# M062X/def2TZVP

SP

0 1
 C                  0.00000000    2.36027000    0.72297100
 C                  0.00000000    1.17716600    1.43280000
 C                  0.00000000    0.00000000    0.67372200
 C                  0.00000000    0.00000000   -0.67372200
 C                  0.00000000    1.17716600   -1.43280000
 C                  0.00000000    2.36027000   -0.72297100
 H                  0.00000000    3.32256800    1.22601400
 C                  0.00000000   -1.17716600    1.43280000
 C                  0.00000000   -1.17716600   -1.43280000
 H                  0.00000000    3.32256800   -1.22601400
 C                  0.00000000   -2.36027000   -0.72297100
 C                  0.00000000   -2.36027000    0.72297100
 H                  0.00000000   -3.32256800   -1.22601400
 H                  0.00000000   -3.32256800    1.22601400
 C                  0.00000000    0.67797700   -2.83838500
 H                  0.00000000    1.29940800   -3.72475500
 C                  0.00000000   -0.67797700   -2.83838500
 H                  0.00000000   -1.29940800   -3.72475500
 C                  0.00000000    0.67797700    2.83838500
 H                  0.00000000    1.29940800    3.72475500
 C                  0.00000000   -0.67797700    2.83838500
 H                  0.00000000   -1.29940800    3.72475500
```

接下来在 Multiwfn 中输入单点计算后的 fch/fchk 文件，由于本文主要介绍如何绘制 LOL-pi 的平面填色图和等值面图，所以在正式绘制之前，还需要通过 Multiwfn 找到体系所有的 pi 电子。在 Multiwfn 中输入以下命令，即可只研究体系的 pi 电子结构。

```basic
100     // 主功能100
22      // 检测 pi 轨道
0       // 自动检测分子平面
2       // 把 pi 轨道以外的轨道占据数清零
0       // 返回主菜单
```

执行命令 0 时，还可以在命令行窗口看见 Multiwfn 自动找到了所有的 pi 电子轨道。如果需要考察输出的 pi 电子轨道，还可以进一步对每个 pi 电子轨道进行分析，但是绘制 LOL-pi 不需要，所以就不过多赘述了。

``` basic
 Total number of pi orbitals:    45
 Total number of electrons in pi orbitals:   14.000000
 Total number of inner-core electrons:    28
 Indices of occupied pi orbitals:
 33,38,40,43-46
```

接下来绘制分子平面上 0.5 埃的 LOL-pi 填色图。在返回主菜单后，接着输入以下命令。

```basic
4        // 绘制平面图
10       // LOL
1        // 填色图
[Enter]  // 按回车用默认的格点数
3        // YZ平面
0.5a     // X=0.5 埃
-8       // 把坐标单位切换为埃，从而与习俗一致
-2       // 修改坐标刻度间隔
2,2,0.1  // X,Y坐标刻度间隔为 2，纵坐标刻度间隔为 0.1
1        // 修改色彩刻度上下限
0,0.85   // 下限和上限
4        // 显示原子标签
7        // 以青色显示
17       // 修改显示原子标签的距离
2        // 原子核位置距离作图平面小于 2 Bohr 的原子都在图上显示出标签
y        // 距离超过 2 Bohr 的原子以较细字体显示标签
8        // 显示化学键
14       // 棕色显示化学键
0        // 保存图像
```

绘制的效果如下图 **(a)** 所示，从图中可以看出，该分子的 pi 电子只是在独立的双键的位置上离域，而没有在整个环形成离域，这或许时该分子不存在芳香性的直接原因。如果觉得图 **(a)** 太过花里胡哨了，想要简约的，可以选择 `19` 改变颜色过渡，这里选择 `13 Black-Orange-Yellow`，绘制的效果如下图 **(b)** 所示。

<img src="2.png" height="90%" width="90%">

除此之外，如果想要绘制 LOL-pi 的等值面图，也可以通过 Multiwfn 绘制，但是使用 VMD 绘制的效果更好，所以这里介绍如何使用 VMD 绘制 LOL-pi 的等值面图。首先需要使用 Multiwfn 将 LOL-pi 的格点数据导出到一个 `cub` 文件中，具体操作如下。

```basic
5     // 计算计算格点数据
10    // LOL
2     // 中质量格点
2     // 输出格点数据到 cub 文件中
```

得到 cub 文件后，将其复制到 VMD 文件目录中，再根据 Sob 老师[《在 VMD 里将 cube 文件瞬间绘制成效果极佳的等值面图的方法》](http://sobereva.com/483)的操作，就可以得到效果很好的 LOL-pi 等值面图，下面分别绘制了 LOL-pi 为 5.0、6.0 和 7.0 的等值面图，绘制效果如下图所示。

<img src="3.png" height="90%" width="90%">

从等值面图可以清晰的发现，尽管 LOL-pi 等值面为 0.5 时，该化合物的 pi 电子也不会在整个大环内离域，并且非双键处的等值面远比双键处的等值面细，当等值面为 0.6 时可以发现，该化合物的 pi 电子只在双键处离域。