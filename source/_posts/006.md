---
title: Fedora Linux + AICD 2.0 绘制磁感应电流图
date: 2023-05-27 23:54:55
tags:
    - AICD
    - Linux
    - Povray
    - 芳香性
    - 磁感生电流
    - 量子化学
categories: 
	- Computer Chemistry
description: 本文主要参考 Sobereva 博客《使用 AICD 2.0 绘制磁感应电流图》(http://sobereva.com/294)、《使用AICD 程序研究电子离域性和磁感应电流密度》(http://sobereva.com/147)。
---

# 系统环境以及准备

本次实验的计算全都是在 Fedora Linux 下的 Gaussian 16 完成的。AICD 2.0 的安装相对于 GIMIC 2.0 安装简单很多，Sob 老师在其博客[《使用 AICD 2.0 绘制磁感应电流图》](http://sobereva.com/294)中已经提供了适合 Gaussian 16 的 AICD 2.0 修改版的安装包，原帖为[《[波函数分析交流] 对 AICD 包进行修改以使之适用于 Gaussian 16》](http://bbs.keinsci.com/thread-13577-1-1.html)，下载后根据 Sob 老师的博文进行安装即可。

# 计算实例

进行整体的磁感应电流图的绘制，首先要进行几何优化，确保分子的结构是正确的。值得一说的是，使用 Gaussian 进行几何优化后，拖入 GaussView 里观看，GaussView 可能会误判分子的成键方式。很多人以为这是优化出错了，其实不然。因为量化计算的本质就是求解薛定谔方程，而在薛定谔方程中是不涉及成键的参数的。因此在量化计算中，不管 GaussView 其有没有显示成键，对解薛定谔方程，都没有任何影响，所以说是否成键对量化计算毫无关系。

本文演示的分子同样在 wB97XD/6-311G* 下进行几何优化，优化代码如下：

```gjf
# wb97xd/6-311g* opt freq

wb97xd_opt

0 1
 C                  0.00000000    2.07671185   -1.25408864
 C                  0.00000000    0.69106480   -0.67461451
 C                  0.00000000    0.75653519    0.77691705
 C                  0.00000000    1.99446227    1.25560271
 C                  0.00000000    2.89420161   -0.08659884
 H                  0.00000000    2.37438283   -2.28184921
 H                  0.00000000    2.31642739    2.27601380
 H                  0.00000000    3.96414654   -0.09747120
 C                  0.00000000   -0.69106480   -0.67461451
 C                  0.00000000   -2.07671185   -1.25408864
 C                  0.00000000   -2.89420161   -0.08659884
 C                  0.00000000   -1.99446227    1.25560271
 C                  0.00000000   -0.75653519    0.77691705
 H                  0.00000000   -2.37438283   -2.28184921
 H                  0.00000000   -2.31642739    2.27601380
 H                  0.00000000   -3.96414654   -0.09747120

```

## 绘制整体磁感应电流图

在已经优化好的结构上，建立一个新的 gjf 文件，任务为 NMR=CSGT，并写上 IOp(10/93=1)，其代表输出电流密度张量到坐标后面的那个文件里。计算级别为 B97-2/def2-TZVP，此级别对于计算 NMR 来说，已经非常精确了。 

```gjf
# b972/def2TZVP NMR=CSGT IOp(10/93=1)

wb97xd/6-311g* opted

0 1
 C                  0.00000000    2.01810200   -1.18968400
 C                  0.00000000    0.70897600   -0.74671800
 C                  0.00000000    0.70875900    0.74676800
 C                  0.00000000    2.01830900    1.18943800
 C                  0.00000000    2.78984000    0.00019900
 H                  0.00000000    2.41023600   -2.19599500
 H                  0.00000000    2.41120300    2.19546600
 H                  0.00000000    3.87578900    0.00051400
 C                  0.00000000   -0.70897600   -0.74671800
 C                  0.00000000   -2.01810200   -1.18968400
 C                  0.00000000   -2.78984000    0.00019900
 C                  0.00000000   -2.01830900    1.18943800
 C                  0.00000000   -0.70875900    0.74676800
 H                  0.00000000   -2.41023600   -2.19599500
 H                  0.00000000   -2.41120300    2.19546600
 H                  0.00000000   -3.87578900    0.00051400

test.txt

```

由于该分子是在垂直于 x 轴的平面上，即外磁场矢量为 1 0 0。接着在 Terminal 中输入：

```bash
AICD -m 4 -b 1 0 0 -s -maxarrow 2.0 -pov AICD_all.out
```

其中 AICD_all.out 是在 Gaussian 中运行后生成的 out 文件，下面简要介绍一下 AICD 命令各参数的具体含义：

- `-m`：指定输出的视角，如果是 `-m 4` 则输出多视角，如果是 `-m 2` 则输出单视角。
- `-b`：指定磁场方向矢量。
- `-s`：使 Povray 渲染时更加平滑。
- `-maxarrow length`：去除长度超过 length 的电流密度箭头。有时候由于数值问题某些箭头会格外的长。设为2.0往往比较合适。
- `-pov`：指定输出文件为 Povray 的输入文件格式。
- `-p`：指定格点数目，如果不指定，默认为 40000。格点数越大，分析耗时就越长。
- `-l xxx`：将 AICD 的等值面设为 xxx，默认是 0.05。设的越小等值面越大，太小的话会导致等值面被盒子边缘所截断而出现窟窿。
- `-rot a b c`：用于调节视角方向，例如 90 0 0 就是做90度旋转。这三个量的设定需自行反复尝试。

> 更多的内容可以参考 Sob 老师的[使用 AICD 程序研究电子离域性和磁感应电流密度](http://sobereva.com/147)和[Visualization of Aromaticity: AICD](https://wongzit.github.io/visualization-of-aromaticity-aicd/)两篇文章。

执行完 AICD 命令后，就会在当前文件夹生成几个文件，将这几个文件拷贝到 Windows 下，接着使用 Povray 渲染器打开后缀为 .RenderMich.pov 的那个文件，在 Povray 窗口左上角设定好分辨率以及是否开启抗锯齿(AA)，然后点击 Run 按钮即可渲染出图像，看到的图像会同时保存到当前目录下的 png 文件中，如下所示：

<img src="1.png" height="90%" width="90%">

值得一提的是，由于分子过大，直接 Run 产生的 png 文件中，分子间可能会挤在一起，不美观。即可以在使用 AICD 命令时加上 `-rot` 参数修改方向解决问题；也可以通过修改 .RenderMich.pov 文件的代码，来达到分开分子的目的。具体操作为：

```pov
object                          // vertical view in the 1st column
{ MolUndMag
  translate < -60,40,0 >
}
object                          // front view in the 1st column
{ MolUndMag
  rotate < 90,0,0 >
  translate < -60,0,0 >
}
object                          // side view in the 1st column
{ MolUndMag
  rotate < 0,90,0 >
  translate < -60,-35,0 >
}


object                          // vertical view in the 2nd column
{ MolUndIso
  translate < -15,40,0 >
}   
object                          // front view in the 2nd column
{ MolUndIso
  rotate < 90,0,0 >
  translate < -15,0,0 >
}
object                          // side view in the 2nd column
{ MolUndIso
  rotate < 0,90,0 >
  translate < -15,-35,0 >
}


object                           // vertical view in the 3rd column
{ MolUndIso
  rotate < 0,180,0 >
  translate < 38,40,0 >
}
object                           // front view in the 3rd column
{ MolUndIso
  rotate < 90,0,0 >
  rotate < 0,180,0 >
  translate < 38,0,0 >
}
object                           // side view in the 3rd column
{ MolUndIso
  rotate < 0,90,0 >
  rotate < 0,180,0 >
  translate < 38,-35,0 >
}
```

<img src="2.png" height="90%" width="90%">

上图就是通过修改 .RenderMich.pov 文件的代码来达到分开重叠分子的目的。除此之外，还可以在使用 AICD 命令时，通过调用 `-m 2` 参数，来生成单视角的磁感应电流图。

<img src="3.png" height="50%" width="50%">

## 绘制 pi 轨道贡献的感应电流图

由于大部分芳香性主要是由 pi 轨道提供的，而通过使用 [Multiwfn](http://sobereva.com/multiwfn/) 可以很方便的分析出分子有哪几个 pi 轨道。对于平面体系来说，最方便的方法就是将分子的 fchk 文件载入 Multiwfn，并依次输入 100、22、0、2（和 Sob 老师原文[使用 AICD 2.0 绘制磁感应电流图](http://sobereva.com/294)略有出入）。程序就会给出所有的 pi MO 轨道的编号，拷贝这些编号到 gjf 末尾，将其命名为 AICD_pi.gjf：

```gjf
# b972/def2TZVP NMR=CSGT IOp(10/93=2)

wb97xd/6-311g* opted

0 1
 C                  0.00000000    2.01810200   -1.18968400
 C                  0.00000000    0.70897600   -0.74671800
 C                  0.00000000    0.70875900    0.74676800
 C                  0.00000000    2.01830900    1.18943800
 C                  0.00000000    2.78984000    0.00019900
 H                  0.00000000    2.41023600   -2.19599500
 H                  0.00000000    2.41120300    2.19546600
 H                  0.00000000    3.87578900    0.00051400
 C                  0.00000000   -0.70897600   -0.74671800
 C                  0.00000000   -2.01810200   -1.18968400
 C                  0.00000000   -2.78984000    0.00019900
 C                  0.00000000   -2.01830900    1.18943800
 C                  0.00000000   -0.70875900    0.74676800
 H                  0.00000000   -2.41023600   -2.19599500
 H                  0.00000000   -2.41120300    2.19546600
 H                  0.00000000   -3.87578900    0.00051400

 test.txt

 22
 28
 31-33

```

计算完成后，同样执行：

```bash
AICD -m 4 -b 1 0 0 -s -maxarrow 2.0 -pov AICD_pi.out
```

修改生成的 .RenderMich.pov 文件，并使用 Povray 渲染得到 pi 轨道的磁感应电流图。

<img src="4.png" height="90%" width="90%">


## 绘制 sigma 轨道贡献的感应电流图

sigma 轨道可以通过总占据轨道减去 pi 轨道得到，将 sigma 轨道的编号拷贝至 AICD_sigma.gjf 文件的末尾：

```gjf
# b972/def2TZVP NMR=CSGT IOp(10/93=2)

wb97xd/6-311g*

0 1
 C                  0.00000000    2.01810200   -1.18968400
 C                  0.00000000    0.70897600   -0.74671800
 C                  0.00000000    0.70875900    0.74676800
 C                  0.00000000    2.01830900    1.18943800
 C                  0.00000000    2.78984000    0.00019900
 H                  0.00000000    2.41023600   -2.19599500
 H                  0.00000000    2.41120300    2.19546600
 H                  0.00000000    3.87578900    0.00051400
 C                  0.00000000   -0.70897600   -0.74671800
 C                  0.00000000   -2.01810200   -1.18968400
 C                  0.00000000   -2.78984000    0.00019900
 C                  0.00000000   -2.01830900    1.18943800
 C                  0.00000000   -0.70875900    0.74676800
 H                  0.00000000   -2.41023600   -2.19599500
 H                  0.00000000   -2.41120300    2.19546600
 H                  0.00000000   -3.87578900    0.00051400

 test.txt

 1-21
 23-27
 29-30

```

计算完成后，同样执行：

```bash
AICD -m 4 -b 1 0 0 -s -maxarrow 2.0 -pov AICD_sigma.out
```

修改生成的 .RenderMich.pov 文件，并使用 Povray 渲染得到 sigma 轨道的磁感应电流图。

<img src="5.png" height="90%" width="90%">

# 分析各轨道的磁感应电流图

分别将全部轨道的、pi 轨道的、sigma 轨道的磁感应电流图汇总一起进行比较分析，如下图所示。对于全部轨道和 pi 轨道，由于 pi 电子是离域的，所以在外磁场的作用下，会产生磁感应环电流，在图中可以很明显的看出来。而对于 sigma 轨道的磁感应电流，由于 sigma 电子不参与共轭，因此在外磁场的作用下，只会在 sigma 键的周围生成局部的环电流。可见 sigma 电子是没有离域性，而 pi 电子是离域的。

<img src="6.png" height="90%" width="90%">

总而言之，通过 AICD 分析，以及前文[ Multiwfn + VMD 绘制 ICSS 等值面图](https://ikuns.icu/004/)中的 ICSS 分析，都是证明本文所研究的分子具有芳香性的证据。